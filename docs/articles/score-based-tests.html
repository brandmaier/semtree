<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SEM Trees with score-based tests â€¢ semtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SEM Trees with score-based tests">
<meta property="og:description" content="semtree">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/constraints.html">Constraints in semtree</a>
    </li>
    <li>
      <a href="../articles/forests.html">SEM Forests</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting Started with the semtree package</a>
    </li>
    <li>
      <a href="../articles/score-based-tests.html">SEM Trees with score-based tests</a>
    </li>
    <li>
      <a href="../articles/semforest-focus.html">Focus parameters in SEM forests</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brandmaier/semtree/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SEM Trees with score-based tests</h1>
                        <h4 data-toc-skip class="author">Andreas M.
Brandmaier</h4>
            
            <h4 data-toc-skip class="date">2024-04-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brandmaier/semtree/blob/HEAD/vignettes/score-based-tests.Rmd" class="external-link"><code>vignettes/score-based-tests.Rmd</code></a></small>
      <div class="hidden name"><code>score-based-tests.Rmd</code></div>

    </div>

    
    
<p>In this example, we will explore how score-based SEM trees can be
used. Score-based tests for variable and split-point selection are
preferable because they are fast to compute, perform unbiased variable
selection, and have better statistical power than some other selection
algorithms proposed earlier.</p>
<p>For this illustration, we will use the <code>affect</code> dataset
and a simple (non-latent) SEM, which just has one observed variable.
Using such a simple model is similar to using a conventional decision
tree or random forest; however, the SEM tree version not only finds
differences in the mean prediction across leafs but also in the
variances (ie., individual differences) of the criterion variable.</p>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>Load affect dataset from the <code>psychTools</code> package. These
are data from two studies conducted in the Personality, Motivation and
Cognition Laboratory at Northwestern University to study affect
dimensionality and the relationship to various personality dimensions.
In the following code, we replace the numeric film labels with the movie
titles. Also, we select a subset of predictors including the film,
personality dimensions, trait anxiety and affect before having watched
the movie.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/" class="external-link">psychTools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">affect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">affect</span><span class="op">$</span><span class="va">Film</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">affect</span><span class="op">$</span><span class="va">Film</span>, ordered <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                      labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Frontline"</span>, <span class="st">"Halloween"</span>, <span class="st">"Nat. Geographic"</span>,<span class="st">"Parenthood"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">tree.data</span> <span class="op">&lt;-</span> <span class="va">affect</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Film"</span>,<span class="st">"neur"</span>,<span class="st">"ext"</span>,<span class="st">"soc"</span>,<span class="st">"traitanx"</span>,<span class="st">"NA1"</span>,<span class="st">"PA1"</span><span class="op">)</span><span class="op">]</span> </span>
<span><span class="va">tree.data</span><span class="op">$</span><span class="va">DeltaPA</span> <span class="op">&lt;-</span> <span class="va">affect</span><span class="op">$</span><span class="va">PA2</span><span class="op">-</span><span class="va">affect</span><span class="op">$</span><span class="va">PA1</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tree.data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Film</th>
<th align="right">neur</th>
<th align="right">ext</th>
<th align="right">soc</th>
<th align="right">traitanx</th>
<th align="right">NA1</th>
<th align="right">PA1</th>
<th align="right">DeltaPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Nat. Geographic</td>
<td align="right">9</td>
<td align="right">18</td>
<td align="right">10</td>
<td align="right">24</td>
<td align="right">2</td>
<td align="right">26</td>
<td align="right">-19</td>
</tr>
<tr class="even">
<td align="left">Nat. Geographic</td>
<td align="right">12</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">41</td>
<td align="right">4</td>
<td align="right">10</td>
<td align="right">-5</td>
</tr>
<tr class="odd">
<td align="left">Nat. Geographic</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">37</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="left">Nat. Geographic</td>
<td align="right">15</td>
<td align="right">12</td>
<td align="right">6</td>
<td align="right">54</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">Nat. Geographic</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">6</td>
<td align="right">39</td>
<td align="right">13</td>
<td align="right">7</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">Frontline</td>
<td align="right">15</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">51</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="create-simple-model-of-state-anxiety">Create simple model of state anxiety<a class="anchor" aria-label="anchor" href="#create-simple-model-of-state-anxiety"></a>
</h2>
<p>Here, we create a simple SEM with a single observed variable. No
latent variables - only two parameters: mean of <code>DeltaPA</code> and
variance of <code>DeltaPA</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://openmx.ssri.psu.edu" class="external-link">OpenMx</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; OpenMx may run faster if it is compiled to take advantage of multiple cores.</span></span>
<span><span class="va">manifests</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DeltaPA"</span><span class="op">)</span></span>
<span><span class="va">latents</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxModel.html" class="external-link">mxModel</a></span><span class="op">(</span><span class="st">"Simple Model"</span>, </span>
<span>type<span class="op">=</span><span class="st">"RAM"</span>,</span>
<span>manifestVars <span class="op">=</span> <span class="va">manifests</span>,</span>
<span>latentVars <span class="op">=</span> <span class="va">latents</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span>from<span class="op">=</span><span class="st">"one"</span>,to<span class="op">=</span><span class="va">manifests</span>, free<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>, value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span> , arrows<span class="op">=</span><span class="fl">1</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span><span class="op">)</span> <span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">manifests</span>,to<span class="op">=</span><span class="va">manifests</span>, free<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>, value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span> , arrows<span class="op">=</span><span class="fl">2</span>, label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma2"</span><span class="op">)</span> <span class="op">)</span>,</span>
<span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxData.html" class="external-link">mxData</a></span><span class="op">(</span><span class="va">tree.data</span>, type <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxRun.html" class="external-link">mxRun</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running Simple Model with 2 parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Simple Model </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; free parameters:</span></span>
<span><span class="co">#&gt;     name matrix     row     col    Estimate Std.Error A</span></span>
<span><span class="co">#&gt; 1 sigma2      S DeltaPA DeltaPA 27.90300741 2.1722417  </span></span>
<span><span class="co">#&gt; 2     mu      M       1 DeltaPA  0.09514715 0.2907414 !</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Statistics: </span></span>
<span><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)</span></span>
<span><span class="co">#&gt;        Model:              2                    328              2034.982</span></span>
<span><span class="co">#&gt;    Saturated:              2                    328                    NA</span></span>
<span><span class="co">#&gt; Independence:              2                    328                    NA</span></span>
<span><span class="co">#&gt; Number of observations/statistics: 330/330</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Information Criteria: </span></span>
<span><span class="co">#&gt;       |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted</span></span>
<span><span class="co">#&gt; AIC:      1378.9818               2038.982                 2039.018</span></span>
<span><span class="co">#&gt; BIC:       132.8794               2046.580                 2040.236</span></span>
<span><span class="co">#&gt; CFI: NA </span></span>
<span><span class="co">#&gt; TLI: 1   (also known as NNFI) </span></span>
<span><span class="co">#&gt; RMSEA:  0  [95% CI (NA, NA)]</span></span>
<span><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): NA</span></span>
<span><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></span>
<span><span class="co">#&gt; timestamp: 2024-04-15 22:33:34 </span></span>
<span><span class="co">#&gt; Wall clock time: 0.02639604 secs </span></span>
<span><span class="co">#&gt; optimizer:  SLSQP </span></span>
<span><span class="co">#&gt; OpenMx version number: 2.21.1 </span></span>
<span><span class="co">#&gt; Need help?  See help(mxSummary)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="score-based-tests">Score-based Tests<a class="anchor" aria-label="anchor" href="#score-based-tests"></a>
</h2>
<p>Use score-based tests to create the tree. Use Bonferroni-correction
to adjust for multiple testing of predictors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/brandmaier/semtree" class="external-link">semtree</a></span><span class="op">)</span></span>
<span><span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="../reference/semtree.control.html">semtree.control</a></span><span class="op">(</span></span>
<span>  method<span class="op">=</span><span class="st">"score"</span>, </span>
<span>  bonferroni <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">=</span> <span class="fu"><a href="../reference/semtree.html">semtree</a></span><span class="op">(</span> model <span class="op">=</span> <span class="va">result</span>, </span>
<span>                data <span class="op">=</span> <span class="va">tree.data</span>, </span>
<span>                control<span class="op">=</span><span class="va">ctrl</span><span class="op">)</span></span></code></pre></div>
<p>Now let us plot the tree.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></code></pre></div>
<p><img src="score-based-tests_files/figure-html/unnamed-chunk-6-1.png" width="75%"></p>
<p>Implied mixture model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tndata</span> <span class="op">&lt;-</span> <span class="fu">semtree</span><span class="fu">::</span><span class="fu"><a href="../reference/getTerminalNodes.html">getTerminalNodes</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">plasma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tndata</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Change in Positive Affect"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tndata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, </span>
<span>      n <span class="op">=</span> <span class="fl">101</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">tndata</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tndata</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span></span></code></pre></div>
<p><img src="score-based-tests_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
<p>Let us inspect the group with the largest negative change. This is
the group of participants, who started out with a high positive affect
and then had to watch a war movie.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">tndata</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">pl</span> <span class="op">+</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_area</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"function"</span>, </span>
<span>                             fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="va">tndata</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tndata</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>, </span>
<span>                             fill <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">10</span>,y<span class="op">=</span><span class="fl">.12</span>, label<span class="op">=</span><span class="st">"People with very high positive \naffect, which then watched\n a war film"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span></span></code></pre></div>
<p><img src="score-based-tests_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andreas M. Brandmaier, John J. Prindle, Manuel Arnold, Caspar J. Van Lissa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
