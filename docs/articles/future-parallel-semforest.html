<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parallel SEM Forests with the future Package • semtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Parallel SEM Forests with the future Package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/constraints.html">Constraints in semtree</a>
    </li>
    <li>
      <a href="../articles/forests.html">SEM Forests</a>
    </li>
    <li>
      <a href="../articles/future-parallel-semforest.html">Parallel SEM Forests with the future Package</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting Started with the semtree package</a>
    </li>
    <li>
      <a href="../articles/score-based-tests.html">SEM Trees with score-based tests</a>
    </li>
    <li>
      <a href="../articles/semforest-focus.html">Focus parameters in SEM forests</a>
    </li>
    <li>
      <a href="../articles/spi-semtree.html">Multiple-Testing Corrections: Personality Structure in the spi Dataset</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brandmaier/semtree/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Parallel SEM Forests with the future
Package</h1>
                        <h4 data-toc-skip class="author">Andreas M.
Brandmaier</h4>
            
            <h4 data-toc-skip class="date">2025-11-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brandmaier/semtree/blob/HEAD/vignettes/future-parallel-semforest.Rmd" class="external-link"><code>vignettes/future-parallel-semforest.Rmd</code></a></small>
      <div class="hidden name"><code>future-parallel-semforest.Rmd</code></div>

    </div>

    
    
<p>This vignette shows how to run SEM forests in parallel using the <a href="https://future.futureverse.org/" class="external-link"><code>future</code></a> package.
The future package provides a standardized way of evaluating R
expressions asynchronously using the computing resources available to
the user – whether it is a single machine with multiple cores or a
computing cluster.</p>
<p>We build on the latent growth curve model from the <em>Getting
Started</em> vignette and use a <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">future::plan()</a></code> to
distribute trees across the available CPU cores of a local machine.</p>
<div class="section level2">
<h2 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/brandmaier/semtree" class="external-link">semtree</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: OpenMx</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openmx.ssri.psu.edu/" class="external-link">OpenMx</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-the-latent-growth-curve-data">Simulate the latent growth curve data<a class="anchor" aria-label="anchor" href="#simulate-the-latent-growth-curve-data"></a>
</h2>
<p>We reuse the linear latent growth curve example: each individual has
five repeated measures (<code>X1</code> to <code>X5</code>) and one
dichotomous predictor (<code>P1</code>) that influences the mean slope.
Setting a seed keeps the simulation reproducible.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">icept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">(</span><span class="va">slope</span> <span class="op">+</span> <span class="va">p1</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">loadings</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">icept</span>, each <span class="op">=</span> <span class="va">M</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="va">M</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">M</span>, sd <span class="op">=</span> <span class="fl">.08</span><span class="op">)</span></span>
<span><span class="va">growth.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">N</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">growth.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span>, <span class="st">"P1"</span>,<span class="st">"Noise"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-and-fit-the-sem">Specify and fit the SEM<a class="anchor" aria-label="anchor" href="#specify-and-fit-the-sem"></a>
</h2>
<p>The model is identical to the one used in the introductory vignette:
a two-factor latent growth curve with fixed factor loadings for the
intercept and slope.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manifests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">growth.data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">growthCurveModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxModel.html" class="external-link">mxModel</a></span><span class="op">(</span><span class="st">"Linear Growth Curve Model Path Specification"</span>,</span>
<span>    type<span class="op">=</span><span class="st">"RAM"</span>,</span>
<span>       manifestVars<span class="op">=</span><span class="va">manifests</span>,</span>
<span>    latentVars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>,<span class="st">"slope"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxData.html" class="external-link">mxData</a></span><span class="op">(</span><span class="va">growth.data</span>, type<span class="op">=</span><span class="st">"raw"</span><span class="op">)</span>,</span>
<span>    <span class="co"># residual variances</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="va">manifests</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">2</span>,</span>
<span>        free<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.1</span>, <span class="fl">.1</span>, <span class="fl">.1</span>, <span class="fl">.1</span><span class="op">)</span>,</span>
<span>        labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"residual"</span>,<span class="st">"residual"</span>,<span class="st">"residual"</span>,<span class="st">"residual"</span>,<span class="st">"residual"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># latent variances and covariance</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>,<span class="st">"slope"</span><span class="op">)</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">2</span>,</span>
<span>        connect<span class="op">=</span><span class="st">"unique.pairs"</span>,</span>
<span>        free<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vari"</span>, <span class="st">"cov"</span>, <span class="st">"vars"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># intercept loadings</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="st">"intercept"</span>,</span>
<span>        to<span class="op">=</span><span class="va">manifests</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">1</span>,</span>
<span>        free<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># slope loadings</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="st">"slope"</span>,</span>
<span>        to<span class="op">=</span><span class="va">manifests</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">1</span>,</span>
<span>        free<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># manifest means</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="st">"one"</span>,</span>
<span>        to<span class="op">=</span><span class="va">manifests</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">1</span>,</span>
<span>        free<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># latent means</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxPath.html" class="external-link">mxPath</a></span><span class="op">(</span></span>
<span>        from<span class="op">=</span><span class="st">"one"</span>,</span>
<span>        to<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intercept"</span>, <span class="st">"slope"</span><span class="op">)</span>,</span>
<span>        arrows<span class="op">=</span><span class="fl">1</span>,</span>
<span>        free<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>        values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meani"</span>, <span class="st">"means"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># close model</span></span>
<span></span>
<span><span class="va">growthCurveModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxRun.html" class="external-link">mxRun</a></span><span class="op">(</span><span class="va">growthCurveModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running Linear Growth Curve Model Path Specification with 6 parameters</span></span>
<span><span class="co">#&gt; Warning: In model 'Linear Growth Curve Model Path Specification' Optimizer</span></span>
<span><span class="co">#&gt; returned a non-zero status code 5. The Hessian at the solution does not appear</span></span>
<span><span class="co">#&gt; to be convex. See ?mxCheckIdentification for possible diagnosis (Mx status</span></span>
<span><span class="co">#&gt; RED).</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="enable-parallelism-with-future">Enable parallelism with <code>future</code><a class="anchor" aria-label="anchor" href="#enable-parallelism-with-future"></a>
</h2>
<p><code><a href="../reference/semforest.html">semtree::semforest()</a></code> uses the <code>future.apply</code>
infrastructure internally, so registering a parallel plan automatically
parallelizes tree construction. Here we choose a conservative number of
workers to keep vignette builds light-weight, that is, a maximum of two
workers (if available), and we restore the previous plan when we’re
done. Please see the documentation of <code>future</code> for other
plans, such as <code>sequential</code> for non-parallel execution or
<code>cluster</code> for using a computing cluster.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old_plan</span> <span class="op">&lt;-</span> <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">old_plan</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="va">workers</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="grow-the-sem-forest-in-parallel">Grow the SEM forest in parallel<a class="anchor" aria-label="anchor" href="#grow-the-sem-forest-in-parallel"></a>
</h2>
<p>With the plan in place, we can grow a forest. We keep the number of
trees modest for the sake of a fast example; in practice, increase
<code>num.trees</code> (e.g., 200–500) for stable variable importance
estimates.</p>
<pre><code><span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4841.4129502689, new current best! (was 4841.68119221572)Beginning fit attempt 1 of at maximum 10 extra tries                        Fit attempt 1, fit=4841.41295026589, new current best! (was 4841.4129502689)                                                                            Beginning initial fit attemptFit attempt 0, fit=2386.6443068647, new current best! (was 2390.91864907122)                                                                            Beginning initial fit attemptFit attempt 0, fit=933.414331788414, new current best! (was 1188.6255269588)                                                                            Beginning initial fit attemptFit attempt 0, fit=927.622724089175, new current best! (was 1198.01877989393)                                                                             Beginning initial fit attemptFit attempt 0, fit=2446.20581882165, new current best! (was 2450.49430121033)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=2446.20581882071, new current best! (was 2446.20581882165)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 2s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4857.99683300402, new current best! (was 4859.21177661586)                                                                             Beginning initial fit attemptFit attempt 0, fit=2043.61820642061, new current best! (was 2554.34370851868)                                                                             Beginning initial fit attemptFit attempt 0, fit=1780.11329988171, new current best! (was 2303.65312449289)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took less than a second].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4837.2179115598, new current best! (was 4840.61442884144)                                                                            Beginning initial fit attemptFit attempt 0, fit=1901.15484935501, new current best! (was 2434.93404806847)                                                                             Beginning initial fit attemptFit attempt 0, fit=1879.95371736256, new current best! (was 2402.28386356542)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took less than a second].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4877.26068018816, new current best! (was 4878.8770102035)Beginning fit attempt 1 of at maximum 10 extra tries                        Fit attempt 1, fit=4877.26068017697, new current best! (was 4877.26068018816)                                                                             Beginning initial fit attemptFit attempt 0, fit=2455.74880690412, new current best! (was 2457.59307648514)                                                                             Beginning initial fit attemptFit attempt 0, fit=2417.87069004512, new current best! (was 2419.66760368406)                                                                             Beginning initial fit attemptFit attempt 0, fit=1009.69527284839, new current best! (was 1285.62730354037)                                                                             Beginning initial fit attemptFit attempt 0, fit=864.404336231437, new current best! (was 1132.2433865349)                                                                            <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4797.07462072364, new current best! (was 4798.39076237284)                                                                             Beginning initial fit attemptFit attempt 0, fit=1944.82725881168, new current best! (was 2499.09633094297)                                                                             Beginning initial fit attemptFit attempt 0, fit=1750.76043665217, new current best! (was 2297.97828985628)                                                                             Beginning initial fit attemptFit attempt 0, fit=956.515708206734, new current best! (was 962.000629661226)                                                                             Beginning initial fit attemptFit attempt 0, fit=780.103283389691, new current best! (was 788.759806995574)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4843.28555041772, new current best! (was 4846.13143455715)                                                                             Beginning initial fit attemptFit attempt 0, fit=2473.97954068927, new current best! (was 2477.95111253351)                                                                             Beginning initial fit attemptFit attempt 0, fit=907.265546877468, new current best! (was 1178.79043644132)                                                                             Beginning initial fit attemptFit attempt 0, fit=1021.28112300835, new current best! (was 1295.18910425902)                                                                             Beginning initial fit attemptFit attempt 0, fit=2360.83101030083, new current best! (was 2365.33443787792)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=2360.83101029861, new current best! (was 2360.83101030083)                                                                             Beginning initial fit attemptFit attempt 0, fit=1075.85549934308, new current best! (was 1351.58198176955)                                                                             Beginning initial fit attemptFit attempt 0, fit=741.186134436971, new current best! (was 1009.2490285674)Beginning fit attempt 1 of at maximum 10 extra tries                        Fit attempt 1, fit=741.186134436551, new current best! (was 741.186134436971)Beginning fit attempt 2 of at maximum 10 extra tries                         Beginning fit attempt 3 of at maximum 10 extra triesBeginning fit attempt 4 of at maximum 10 extra triesBeginning fit attempt 5 of at maximum 10 extra triesBeginning fit attempt 6 of at maximum 10 extra triesBeginning fit attempt 7 of at maximum 10 extra triesBeginning fit attempt 8 of at maximum 10 extra triesBeginning fit attempt 9 of at maximum 10 extra triesBeginning fit attempt 10 of at maximum 10 extra tries                                                     <span style="color: #00BB00;">✔</span> Tree construction finished [took 2s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4740.87356224327, new current best! (was 4742.94988525661)                                                                             Beginning initial fit attemptFit attempt 0, fit=1987.16384152455, new current best! (was 2501.00102936027)                                                                             Beginning initial fit attemptFit attempt 0, fit=1723.7612009215, new current best! (was 2239.87253285012)                                                                            Beginning initial fit attemptFit attempt 0, fit=967.232366318714, new current best! (was 972.810893807774)                                                                             Beginning initial fit attemptFit attempt 0, fit=743.215563275571, new current best! (was 750.950307096374)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=743.215563273839, new current best! (was 743.215563275571)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4885.05897783269, new current best! (was 4886.26235257213)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=4885.05897782651, new current best! (was 4885.05897783269)                                                                             Beginning initial fit attemptFit attempt 0, fit=2464.32900562986, new current best! (was 2470.76759441273)                                                                             Beginning initial fit attemptFit attempt 0, fit=993.483010209017, new current best! (was 1238.03252556992)                                                                             Beginning initial fit attemptFit attempt 0, fit=952.389689284671, new current best! (was 1226.29648005032)                                                                             Beginning initial fit attemptFit attempt 0, fit=2407.20648366729, new current best! (was 2414.29138332742)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4848.28071768685, new current best! (was 4850.81501043059)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=4848.2807176816, new current best! (was 4848.28071768685)                                                                            Beginning initial fit attemptFit attempt 0, fit=2469.22523372227, new current best! (was 2476.615680638)                                                                           Beginning initial fit attemptFit attempt 0, fit=954.793849932762, new current best! (was 1237.72566830339)                                                                             Beginning initial fit attemptFit attempt 0, fit=942.277311486197, new current best! (was 1231.49956536966)                                                                             Beginning initial fit attemptFit attempt 0, fit=2363.81170620688, new current best! (was 2371.66503716345)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4832.50378626754, new current best! (was 4834.60301704753)                                                                             Beginning initial fit attemptFit attempt 0, fit=2002.03422991225, new current best! (was 2550.55216666672)                                                                             Beginning initial fit attemptFit attempt 0, fit=953.157968486568, new current best! (was 955.205678494332)                                                                             Beginning initial fit attemptFit attempt 0, fit=1044.98518133996, new current best! (was 1046.82855138445)                                                                             Beginning initial fit attemptFit attempt 0, fit=1728.81097960556, new current best! (was 2281.95161964954)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4838.30329089626, new current best! (was 4839.69453713705)                                                                             Beginning initial fit attemptFit attempt 0, fit=1931.61992456887, new current best! (was 2443.97255945332)                                                                             Beginning initial fit attemptFit attempt 0, fit=1864.39482482846, new current best! (was 2394.33073141645)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4815.73245572566, new current best! (was 4816.10818458514)                                                                             Beginning initial fit attemptFit attempt 0, fit=2475.22199878845, new current best! (was 2479.99791831093)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=2475.22199878732, new current best! (was 2475.22199878845)                                                                             Beginning initial fit attemptFit attempt 0, fit=2330.2738869442, new current best! (was 2335.73453739355)                                                                            Beginning initial fit attemptFit attempt 0, fit=1034.4680635937, new current best! (was 1289.11222984357)                                                                            Beginning initial fit attemptFit attempt 0, fit=789.692127718965, new current best! (was 1041.16165711098)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4766.80701495913, new current best! (was 4767.8832438517)                                                                            Beginning initial fit attemptFit attempt 0, fit=1917.1036870605, new current best! (was 2476.50135952985)                                                                            Beginning initial fit attemptFit attempt 0, fit=1762.44980486545, new current best! (was 2290.30565539497)                                                                             Beginning initial fit attemptFit attempt 0, fit=958.743305635649, new current best! (was 963.3258765412)                                                                           Beginning initial fit attemptFit attempt 0, fit=792.862686353358, new current best! (was 799.123928326935)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4825.57164723138, new current best! (was 4826.61394093424)                                                                             Beginning initial fit attemptFit attempt 0, fit=1945.72610223376, new current best! (was 2503.19585707468)                                                                             Beginning initial fit attemptFit attempt 0, fit=1794.17783811362, new current best! (was 2322.37579001318)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took less than a second].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4759.79018090796, new current best! (was 4762.95192064227)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=4759.790180905, new current best! (was 4759.79018090796)                                                                           Beginning initial fit attemptFit attempt 0, fit=2021.83680962457, new current best! (was 2527.55274066178)                                                                             Beginning initial fit attemptFit attempt 0, fit=950.947309081485, new current best! (was 953.18841716907)                                                                            Beginning initial fit attemptFit attempt 0, fit=1066.60106267887, new current best! (was 1068.64839246678)                                                                             Beginning initial fit attemptFit attempt 0, fit=1706.77845806714, new current best! (was 2232.23744027947)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4792.56044371011, new current best! (was 4793.25942269636)                                                                             Beginning initial fit attemptFit attempt 0, fit=2477.12921152579, new current best! (was 2484.67129590925)                                                                             Beginning initial fit attemptFit attempt 0, fit=2299.84121281263, new current best! (was 2307.8891477889)Beginning fit attempt 1 of at maximum 10 extra tries                        Fit attempt 1, fit=2299.84121281073, new current best! (was 2299.84121281263)                                                                             Beginning initial fit attemptFit attempt 0, fit=1018.91678628493, new current best! (was 1283.93181386932)                                                                             Beginning initial fit attemptFit attempt 0, fit=751.851984963089, new current best! (was 1015.90939896056)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 2s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4816.01457604909, new current best! (was 4818.703991084)Beginning fit attempt 1 of at maximum 10 extra tries                       Fit attempt 1, fit=4816.01457604293, new current best! (was 4816.01457604909)                                                                             Beginning initial fit attemptFit attempt 0, fit=1972.26018811376, new current best! (was 2491.30644425653)                                                                             Beginning initial fit attemptFit attempt 0, fit=1790.38190255829, new current best! (was 2324.70813180017)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took less than a second].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4848.46694579256, new current best! (was 4849.91198197862)                                                                             Beginning initial fit attemptFit attempt 0, fit=2422.48994008734, new current best! (was 2427.58654115739)                                                                             Beginning initial fit attemptFit attempt 0, fit=2415.065507095, new current best! (was 2420.88040474833)Beginning fit attempt 1 of at maximum 10 extra tries                       Fit attempt 1, fit=2415.06550709467, new current best! (was 2415.065507095)                                                                           <span style="color: #00BB00;">✔</span> Tree construction finished [took less than a second].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4751.03354812164, new current best! (was 4755.23806730752)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=4751.03354811434, new current best! (was 4751.03354812164)                                                                             Beginning initial fit attemptFit attempt 0, fit=2315.19763865933, new current best! (was 2318.30117448961)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=2315.19763865811, new current best! (was 2315.19763865933)                                                                             Beginning initial fit attemptFit attempt 0, fit=945.749592664899, new current best! (was 1191.29911109765)                                                                             Beginning initial fit attemptFit attempt 0, fit=856.864839161509, new current best! (was 1123.89852755215)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=856.864839160505, new current best! (was 856.864839161509)                                                                             Beginning initial fit attemptFit attempt 0, fit=2429.61196434522, new current best! (was 2432.7323737125)                                                                            <span style="color: #00BB00;">✔</span> Tree construction finished [took 1s].</span></span>
<span><span class="co">#&gt; Beginning initial fit attemptFit attempt 0, fit=4826.1893879509, new current best! (was 4829.00149100655)                                                                            Beginning initial fit attemptFit attempt 0, fit=2022.31943600189, new current best! (was 2524.97809631185)                                                                             Beginning initial fit attemptFit attempt 0, fit=954.133949182883, new current best! (was 956.418957565883)                                                                             Beginning initial fit attemptFit attempt 0, fit=1063.97419812605, new current best! (was 1065.90047837627)                                                                             Beginning initial fit attemptFit attempt 0, fit=1764.07469136654, new current best! (was 2301.2112917175)                                                                            Beginning initial fit attemptFit attempt 0, fit=979.206023435045, new current best! (was 982.860386711498)                                                                             Beginning initial fit attemptFit attempt 0, fit=776.342898195711, new current best! (was 781.214304632694)Beginning fit attempt 1 of at maximum 10 extra tries                         Fit attempt 1, fit=776.342898195491, new current best! (was 776.342898195711)Beginning fit attempt 2 of at maximum 10 extra tries                         Fit attempt 2, fit=776.342898194957, new current best! (was 776.342898195491)                                                                             <span style="color: #00BB00;">✔</span> Tree construction finished [took 2s].</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Forest completed [took 17s]</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="inspect-variable-importance">Inspect variable importance<a class="anchor" aria-label="anchor" href="#inspect-variable-importance"></a>
</h2>
<p>Because the latent growth data only include the grouping predictor
<code>P1</code>, importance results confirm that this variable drives
heterogeneity in the model parameters. Parallel evaluation speeds up the
permutation step when multiple predictors are present.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varimp.html">varimp</a></span><span class="op">(</span><span class="va">forest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">vim</span>, sort.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Variable Importance</span></span>
<span><span class="co">#&gt;       Noise          P1 </span></span>
<span><span class="co">#&gt;    1.275821 2629.865681</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vim</span><span class="op">)</span></span></code></pre></div>
<p><img src="future-parallel-semforest_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>After the forest is built, <code>future::plan(old_plan)</code>
(triggered via <code>on.exit</code>) returns the session to its prior
parallel configuration.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Andreas M. Brandmaier, John J. Prindle, Manuel Arnold, Caspar J. Van Lissa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
